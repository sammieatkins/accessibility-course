---
import { getGroupedLessons } from "../utils/getGroupedLessons";
const rawGroups = await getGroupedLessons();

const formattedLessonsArray = rawGroups.map(({ index, folder, lessons }) => {
  const title = folder
    .replace(/^\d+_/, "")
    .replace(/-/g, " ")
    .replace(/\b\w/g, (char) => char.toUpperCase());

  return { index, title, lessons };
});
---

<nav
  id="merged-sidebar"
  role="navigation"
  aria-label="Lessons Navigation"
  class="w-96 overflow-y-scroll bg-lightgray px-3 py-4 text-primary"
>
  {
    formattedLessonsArray.map(({ index, title, lessons }) => (
      <div class="mb-6">
        <h2 class="mb-2 pl-2 text-lg font-black text-darkergray">
          Lesson {index}: {title}
        </h2>
        <ul class="pl-4 space-y-2 font-medium side-nav">
          {lessons
            .filter((lesson) => !lesson.id.endsWith("home.md"))
            .map((lesson) => (
              <li>
                <a
                  href={`/lessons/${lesson.slug}`}
                  class="sidenav-links block w-full p-2 rounded-lg text-md text-text-color hover:bg-accent-color hover:text-primary transition font-bold"
                >
                  {lesson.data.title}
                </a>
              </li>
            ))}
        </ul>
      </div>
    ))
  }
</nav>
